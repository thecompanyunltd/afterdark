<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta charset="UTF-8" />
  <title>RSVP for Party</title>
<style>
    /* Base styles */
    :root {
      --mobile-padding: 1rem;
    }
    
    body {
      margin: 0;
      font-family: 'Cascadia Code', monospace;
      background-color: #000;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      min-height: 100vh;
      -webkit-text-size-adjust: 100%;
    }

    .waves-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }

    header img {
      width: 100%;
      max-width: 1000px;
      height: auto;
      display: block;
      margin-top: 1rem;
      padding: 0 var(--mobile-padding);
      box-sizing: border-box;
    }

    .content-box {
      background-color: rgba(0, 0, 0, 0.7);
      padding: var(--mobile-padding);
      border-radius: 15px;
      margin: 1rem auto;
      max-width: 800px;
      width: calc(100% - 2rem);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
      box-sizing: border-box;
    }

    h1 {
      font-family: 'Baskerville Old Style', serif;
      font-size: clamp(1.5rem, 5vw, 2.5rem);
      margin-top: 0;
      color: #fff;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    label {
      font-size: clamp(0.9rem, 3vw, 1.1rem);
      color: #ddd;
    }

    input, textarea, select {
      padding: 0.8rem;
      border-radius: 8px;
      border: 1px solid #444;
      background-color: rgba(255, 255, 255, 0.1) !important;
      color: white;
      font-family: inherit;
      font-size: 1rem;
      width: 100%;
      box-sizing: border-box;
      -webkit-appearance: none;
      min-height: 44px; /* Better touch target */
    }

    /* Improved dropdown styling */
    select {
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 0.7em top 50%;
      background-size: 1em;
      padding-right: 2em;
    }

    select option {
      background-color: #000;
      color: white;
    }

    textarea {
      min-height: 120px;
      resize: vertical;
    }

    button {
      padding: 1rem;
      border-radius: 8px;
      border: none;
      background: linear-gradient(45deg, #e40303, #ff8c00);
      color: white;
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
      margin-top: 0.5rem;
      transition: transform 0.2s, box-shadow 0.2s;
      width: 100%;
      -webkit-tap-highlight-color: transparent;
    }

    button:hover, button:focus {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }

    .thank-you {
      text-align: center;
      display: none;
    }

    .thank-you h2 {
      color: #ff8c00;
      font-size: clamp(1.5rem, 5vw, 2rem);
    }

    .comment-section {
      margin-top: 1.5rem;
      display: none;
    }

    footer {
      margin: 1rem auto;
      font-size: 0.8rem;
      color: #aaa;
      background-color: rgba(0, 0, 0, 0.7);
      padding: 0.8rem;
      border-radius: 10px;
      width: calc(100% - 2rem);
      text-align: center;
      box-sizing: border-box;
    }

    /* Mobile-specific adjustments */
    @media (max-width: 600px) {
      :root {
        --mobile-padding: 1rem;
      }
      
      .content-box {
        padding: 1rem;
        margin: 0.5rem auto;
        width: calc(100% - 1rem);
      }
      
      input, textarea, select {
        padding: 0.7rem;
      }
      
      textarea {
        min-height: 100px;
      }
      
      .thank-you p {
        margin: 0.8rem 0;
      }
    }

    /* Very small devices */
    @media (max-width: 400px) {
      :root {
        --mobile-padding: 0.8rem;
      }
      
      button {
        padding: 0.9rem;
      }
    }
</style>
</head>
<body>
  <div class="waves-container">
    <canvas class="waves-canvas"></canvas>
  </div>

  <header>
    <img src="Adobe Express - file.png" alt="Gay After Dark Logo" />
  </header>

  <div class="content-box">
    <h1>RSVP for the Party</h1>
    
    <form id="rsvpForm">
      <div class="form-group">
        <label for="name">Your Name</label>
        <input type="text" id="name" name="name" required>
      </div>
      
      <div class="form-group">
        <label for="phone">Phone Number</label>
        <input type="phone" id="phone" name="phone" required>
      </div>
      
      <div class="form-group">
        <label for="attending">Will you be attending?</label>
        <select id="attending" name="attending" required>
          <option value="">Select an option</option>
          <option value="yes">Absolutely! Wouldn't miss it!</option>
          <option value="no">Sorry, can't make it</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="guests">Number of guests (including you)</label>
        <input type="number" id="guests" name="guests" min="1" value="1" required>
      </div>
      
      <div class="form-group">
        <label for="message">Anything we should know? (Allergies, special requests, etc.)</label>
        <textarea id="message" name="message"></textarea>
      </div>
      
      <button type="submit">Submit RSVP</button>
    </form>
    
    <div class="thank-you" id="thankYou">
      <h2>Thank You!</h2>
      <p>Your RSVP has been received. We can't wait to see you at the party!</p>
      <p>Feel free to leave a message on our notice board about what you're looking forward to:</p>
      
      <div class="comment-section" id="commentSection">
        <div class="form-group">
          <label for="comment">Your Message</label>
          <textarea id="comment" name="comment" placeholder="What are you most excited about?"></textarea>
        </div>
        <button id="submitComment">Post to Notice Board</button>
        <p><a href="noticeboard.html" style="color: #ff8c00;">View Notice Board</a></p>
      </div>
    </div>
  </div>

  <footer>
    Made with love for the drama queens & night creatures ðŸŒ™
  </footer>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  
  <!-- Firebase Config -->
  <script src="firebase-config.js"></script>
  
  <!-- Waves Animation (same as original) -->
  <script>
    // Same wave animation script as in your original code
    class Grad {
      constructor(x, y, z) {
        this.x = x; this.y = y; this.z = z;
      }
      dot2(x, y) { return this.x * x + this.y * y; }
    }

    class Noise {
      constructor(seed = 0) {
        this.grad3 = [
          new Grad(1, 1, 0), new Grad(-1, 1, 0), new Grad(1, -1, 0), new Grad(-1, -1, 0),
          new Grad(1, 0, 1), new Grad(-1, 0, 1), new Grad(1, 0, -1), new Grad(-1, 0, -1),
          new Grad(0, 1, 1), new Grad(0, -1, 1), new Grad(0, 1, -1), new Grad(0, -1, -1)
        ];
        this.p = [151, 160, 137, 91, 90, 15, 131, 13, 201, 95, 96, 53, 194, 233, 7, 225, 140, 36, 103, 30,
          69, 142, 8, 99, 37, 240, 21, 10, 23, 190, 6, 148, 247, 120, 234, 75, 0, 26, 197, 62, 94, 252, 219,
          203, 117, 35, 11, 32, 57, 177, 33, 88, 237, 149, 56, 87, 174, 20, 125, 136, 171, 168, 68, 175, 74,
          165, 71, 134, 139, 48, 27, 166, 77, 146, 158, 231, 83, 111, 229, 122, 60, 211, 133, 230, 220, 105,
          92, 41, 55, 46, 245, 40, 244, 102, 143, 54, 65, 25, 63, 161, 1, 216, 80, 73, 209, 76, 132, 187, 208,
          89, 18, 169, 200, 196, 135, 130, 116, 188, 159, 86, 164, 100, 109, 198, 173, 186, 3, 64, 52, 217,
          226, 250, 124, 123, 5, 202, 38, 147, 118, 126, 255, 82, 85, 212, 207, 206, 59, 227, 47, 16, 58, 17,
          182, 189, 28, 42, 223, 183, 170, 213, 119, 248, 152, 2, 44, 154, 163, 70, 221, 153, 101, 155, 167,
          43, 172, 9, 129, 22, 39, 253, 19, 98, 108, 110, 79, 113, 224, 232, 178, 185, 112, 104, 218, 246,
          97, 228, 251, 34, 242, 193, 238, 210, 144, 12, 191, 179, 162, 241, 81, 51, 145, 235, 249, 14, 239,
          107, 49, 192, 214, 31, 181, 199, 106, 157, 184, 84, 204, 176, 115, 121, 50, 45, 127, 4, 150, 254,
          138, 236, 205, 93, 222, 114, 67, 29, 24, 72, 243, 141, 128, 195, 78, 66, 215, 61, 156, 180
        ];
        this.perm = new Array(512);
        this.gradP = new Array(512);
        this.seed(seed);
      }
      seed(seed) {
        if (seed > 0 && seed < 1) seed *= 65536;
        seed = Math.floor(seed);
        if (seed < 256) seed |= seed << 8;
        for (let i = 0; i < 256; i++) {
          let v = (i & 1) ? (this.p[i] ^ (seed & 255)) : (this.p[i] ^ ((seed >> 8) & 255));
          this.perm[i] = this.perm[i + 256] = v;
          this.gradP[i] = this.gradP[i + 256] = this.grad3[v % 12];
        }
      }
      fade(t) { return t * t * t * (t * (t * 6 - 15) + 10); }
      lerp(a, b, t) { return (1 - t) * a + t * b; }
      perlin2(x, y) {
        let X = Math.floor(x), Y = Math.floor(y);
        x -= X; y -= Y; X &= 255; Y &= 255;
        const n00 = this.gradP[X + this.perm[Y]].dot2(x, y);
        const n01 = this.gradP[X + this.perm[Y + 1]].dot2(x, y - 1);
        const n10 = this.gradP[X + 1 + this.perm[Y]].dot2(x - 1, y);
        const n11 = this.gradP[X + 1 + this.perm[Y + 1]].dot2(x - 1, y - 1);
        const u = this.fade(x);
        return this.lerp(
          this.lerp(n00, n10, u),
          this.lerp(n01, n11, u),
          this.fade(y)
        );
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      const container = document.querySelector('.waves-container');
      const canvas = document.querySelector('.waves-canvas');
      const ctx = canvas.getContext('2d');
      
      // Pride colors configuration
      const prideColors = [
        "#e40303", // Red
        "#ff8c00", // Orange
        "#ffed00", // Yellow
        "#008026", // Green
        "#004dff", // Blue
        "#750787"  // Purple
      ];

      // Configuration
      const config = {
        backgroundColor: "transparent",
        waveSpeedX: 0.0125,
        waveSpeedY: 0.01,
        waveAmpX: 32,
        waveAmpY: 16,
        xGap: 10,
        yGap: 16,
        friction: 0.925,
        tension: 0.005,
        maxCursorMove: 100
      };

      const noise = new Noise(Math.random());
      let lines = [];
      const mouse = {
        x: -10, y: 0, lx: 0, ly: 0, sx: 0, sy: 0, v: 0, vs: 0, a: 0, set: false
      };
      let frameId = null;
      let bounding = { width: 0, height: 0, left: 0, top: 0 };

      function setSize() {
        bounding = container.getBoundingClientRect();
        canvas.width = bounding.width;
        canvas.height = bounding.height;
      }

      function setLines() {
        const { width, height } = bounding;
        lines = [];
        const oWidth = width + 200, oHeight = height + 30;
        const { xGap, yGap } = config;
        const totalLines = Math.ceil(oWidth / xGap);
        const totalPoints = Math.ceil(oHeight / yGap);
        const xStart = (width - xGap * totalLines) / 2;
        const yStart = (height - yGap * totalPoints) / 2;

        for (let i = 0; i <= totalLines; i++) {
          const pts = [];
          for (let j = 0; j <= totalPoints; j++) {
            pts.push({
              x: xStart + xGap * i,
              y: yStart + yGap * j,
              wave: { x: 0, y: 0 },
              cursor: { x: 0, y: 0, vx: 0, vy: 0 }
            });
          }
          pts.color = prideColors[Math.floor(Math.random() * prideColors.length)];
          lines.push(pts);
        }
      }

      function movePoints(time) {
        const { waveSpeedX, waveSpeedY, waveAmpX, waveAmpY, friction, tension, maxCursorMove } = config;
        lines.forEach((pts) => {
          pts.forEach((p) => {
            const move = noise.perlin2(
              (p.x + time * waveSpeedX) * 0.002,
              (p.y + time * waveSpeedY) * 0.0015
            ) * 12;
            p.wave.x = Math.cos(move) * waveAmpX;
            p.wave.y = Math.sin(move) * waveAmpY;

            const dx = p.x - mouse.sx, dy = p.y - mouse.sy;
            const dist = Math.hypot(dx, dy), l = Math.max(175, mouse.vs);
            if (dist < l) {
              const s = 1 - dist / l;
              const f = Math.cos(dist * 0.001) * s;
              p.cursor.vx += Math.cos(mouse.a) * f * l * mouse.vs * 0.00065;
              p.cursor.vy += Math.sin(mouse.a) * f * l * mouse.vs * 0.00065;
            }

            p.cursor.vx += (0 - p.cursor.x) * tension;
            p.cursor.vy += (0 - p.cursor.y) * tension;
            p.cursor.vx *= friction;
            p.cursor.vy *= friction;
            p.cursor.x += p.cursor.vx * 2;
            p.cursor.y += p.cursor.vy * 2;
            p.cursor.x = Math.min(maxCursorMove, Math.max(-maxCursorMove, p.cursor.x));
            p.cursor.y = Math.min(maxCursorMove, Math.max(-maxCursorMove, p.cursor.y));
          });
        });
      }

      function moved(point, withCursor = true) {
        const x = point.x + point.wave.x + (withCursor ? point.cursor.x : 0);
        const y = point.y + point.wave.y + (withCursor ? point.cursor.y : 0);
        return { x: Math.round(x * 10) / 10, y: Math.round(y * 10) / 10 };
      }

      function drawLines() {
        const { width, height } = bounding;
        ctx.clearRect(0, 0, width, height);

        // Optional pride glow background
        const gradient = ctx.createLinearGradient(0, 0, width, height);
        gradient.addColorStop(0, "rgba(228, 3, 3, 0.1)");
        gradient.addColorStop(0.2, "rgba(255, 140, 0, 0.1)");
        gradient.addColorStop(0.4, "rgba(255, 237, 0, 0.1)");
        gradient.addColorStop(0.6, "rgba(0, 128, 38, 0.1)");
        gradient.addColorStop(0.8, "rgba(0, 77, 255, 0.1)");
        gradient.addColorStop(1, "rgba(117, 7, 135, 0.1)");
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, width, height);

        lines.forEach((points) => {
          ctx.beginPath();
          let p1 = moved(points[0], false);
          ctx.moveTo(p1.x, p1.y);
          for (let idx = 1; idx < points.length; idx++) {
            const p = points[idx];
            const p2 = moved(p, true);
            ctx.lineTo(p2.x, p2.y);
          }
          ctx.strokeStyle = points.color || "#fff";
          ctx.lineWidth = 2;
          ctx.stroke();
        });
      }

      function tick(t) {
        mouse.sx += (mouse.x - mouse.sx) * 0.1;
        mouse.sy += (mouse.y - mouse.sy) * 0.1;
        const dx = mouse.x - mouse.lx, dy = mouse.y - mouse.ly;
        const d = Math.hypot(dx, dy);
        mouse.v = d;
        mouse.vs += (d - mouse.vs) * 0.1;
        mouse.vs = Math.min(100, mouse.vs);
        mouse.lx = mouse.x; mouse.ly = mouse.y;
        mouse.a = Math.atan2(dy, dx);

        movePoints(t);
        drawLines();
        frameId = requestAnimationFrame(tick);
      }

      function onResize() {
        setSize();
        setLines();
      }

      function onMouseMove(e) { updateMouse(e.clientX, e.clientY); }
      function onTouchMove(e) {
        e.preventDefault();
        const touch = e.touches[0];
        updateMouse(touch.clientX, touch.clientY);
      }

      function updateMouse(x, y) {
        mouse.x = x - bounding.left;
        mouse.y = y - bounding.top;
        if (!mouse.set) {
          mouse.sx = mouse.x; mouse.sy = mouse.y;
          mouse.lx = mouse.x; mouse.ly = mouse.y;
          mouse.set = true;
        }
      }

      // Initialize
      setSize();
      setLines();
      frameId = requestAnimationFrame(tick);
      window.addEventListener("resize", onResize);
      //window.addEventListener("mousemove", onMouseMove);
      //window.addEventListener("touchmove", onTouchMove, { passive: false });
    });
  </script>

 <script>
    document.addEventListener('DOMContentLoaded', function() {
      const rsvpForm = document.getElementById('rsvpForm');
      const thankYou = document.getElementById('thankYou');
      const commentSection = document.getElementById('commentSection');
      
      // Better form submission handling
      async function submitRSVP(e) {
        if (e) e.preventDefault();
        
        // Get form values
        const name = document.getElementById('name').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const attending = document.getElementById('attending').value;
        const guests = document.getElementById('guests').value;
        const message = document.getElementById('message').value.trim();
        
        // Validate form
        if (!name || !phone || !attending) {
          alert('Please fill in all required fields');
          return;
        }
        
        try {
          // Save to Firestore
          await db.collection('checkins').add({
            name: name,
            phone: phone,
            attending: attending,
            guests: guests,
            message: message,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
          });
          
          // Hide form, show thank you message
          rsvpForm.style.display = 'none';
          thankYou.style.display = 'block';
          commentSection.style.display = 'block';
          
          // Store in localStorage to remember they've RSVP'd
          localStorage.setItem('hasRSVPd', 'true');
          
          // Scroll to thank you message
          setTimeout(() => {
            thankYou.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          }, 300);
        } catch (error) {
          console.error('Error adding document: ', error);
          alert('There was an error submitting your RSVP. Please try again.');
        }
      }
      
      // Form submission
      rsvpForm.addEventListener('submit', submitRSVP);
      
      // Touch support for form submission
      rsvpForm.querySelector('button[type="submit"]').addEventListener('touchend', function(e) {
        e.preventDefault();
        submitRSVP();
      });
      
      // Handle comment submission
      document.getElementById('submitComment').addEventListener('click', async function() {
        const comment = document.getElementById('comment').value.trim();
        const name = document.getElementById('name').value.trim();
        
        if (!comment) {
          alert('Please enter a message before posting.');
          return;
        }
        
        try {
          await db.collection('comments').add({
            name: name,
            comment: comment,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
          });
          
          // Show success message
          const successMsg = document.createElement('div');
          successMsg.textContent = 'Message posted!';
          successMsg.style.position = 'fixed';
          successMsg.style.bottom = '20px';
          successMsg.style.left = '50%';
          successMsg.style.transform = 'translateX(-50%)';
          successMsg.style.backgroundColor = 'rgba(0,0,0,0.8)';
          successMsg.style.color = '#ff8c00';
          successMsg.style.padding = '10px 20px';
          successMsg.style.borderRadius = '20px';
          successMsg.style.zIndex = '1000';
          document.body.appendChild(successMsg);
          
          // Clear the form
          document.getElementById('comment').value = '';
          
          setTimeout(() => {
            document.body.removeChild(successMsg);
          }, 2000);
        } catch (error) {
          console.error('Error adding comment: ', error);
          alert('There was an error posting your message. Please try again.');
        }
      });
      
      // Check if they've already RSVP'd
      if (localStorage.getItem('hasRSVPd') === 'true') {
        rsvpForm.style.display = 'none';
        thankYou.style.display = 'block';
        commentSection.style.display = 'block';
      }
      
      // Better input focus handling for mobile
      const inputs = document.querySelectorAll('input, textarea, select');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          setTimeout(() => {
            this.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }, 300);
        });
      });
    });
</script>
</body>
</html>